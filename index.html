<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cthulhu: Death May Die (RNG)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      position: relative;
      min-height: 100vh;
    }

    #gameGrid {
      margin-top: 30px;
      display: grid;
      grid-template-rows: auto auto auto auto;
      gap: 40px;
    }

    .player-box {
      border: 2px solid #444;
      padding: 10px;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background-color: #f7f7f7;
    }

    #playerResults {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
    }

    .player-output, .relic-output, .disorder-output {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.1em;
    }

    #gameGrid img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      border: none;
    }

    em.bold-italic {
      font-style: italic;
      font-weight: bold;
    }

    @media (max-width: 600px) {
      #gameGrid img {
        width: 80px;
        height: 80px;
      }

      #playerResults {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
      }
    }
  </style>
</head>
<body>
  <h1>Cthulhu: Death May Die (RNG)</h1>

  <div class="section">
    <label>Number of players (1–5): 
      <input type="number" id="numPlayers" min="1" max="5" value="3" />
    </label>
  </div>

  <div class="section">
    <button onclick="generate()">Generate</button>
  </div>

  <div id="gameGrid">
    <div id="playerResults"></div>
    <div id="bossSection"></div>
    <div id="episodeSection"></div>
  </div>

  <script>
    const words1to20 = [
      "Lord Adam Benchley", "Ahmed Yasin", "Borden", "Elizabeth Ives", "Fatima Safar",
      "Sergeant Ian Welles", "John Morgan", "Rasputin", "Sister Beth", "The Kid",
      "Adilah Vidal", "Alex Parker", "Ariele Venturi", "Hailia Hovath", "Father Luke",
      "Margarethe Richter", "Sergeant Mario Braghieri", "Mary Diaz", "Sam Wood", "Mate Tony Boyle"
    ];

    const words1to4 = ["Cthulhu", "Hastur", "Black Goat of the Woods", "Yog-Sothoth"];

    const episodes1to12 = [
      "S01E01 - Blasphemous Alchemy", "S01E02 - Tomes of Madness", "S01E03 - Danse Macabre", "S01E04 - Eldritch Idols", "S01E05 - Accursed Tide", "S01E06 - Unspeakable Hour",
      "S02E01 - Strange Bedfellows", "S02E02 - Nameless Woods", "S02E03 - Sanctificetur Nomen", "S02E04 - Shootout at the H.P. Corral", "S02E05 - Monsters in Sin City", "S02E06 - Endgame"
    ];

    const relics1to22 = [
      "Skull", "Pumpkin", "Ivory Figure", "Skull Bracelet", "Viol", "Wooden Pipe", "Ritual Dagger", "Glowing Ring", "Old Rosary", "Handheld Magnifier", "Sinister Book", "Jade Amulet",
      "Replica Blade", "Runecarved Spear", "Shiny Jewel", "Ancient Idol", "Lucky Coin", "Mysterious Key", "Ritual Mask", "Crystal Ball", "Brass Compass", "Ruby Talisman"
    ];

    const pathologies1to12 = [
      "Catatonia", "Codependency", "Fear of Crowds", "Hypochondria", "Kleptomania", "Masochism",
      "Obsessive Disorder", "Paranoia", "Psychotic Outbreaks", "Pyromania", "Recurring Trauma", "Short-Term Memory Loss"
    ];

    function sanitizeFileName(name) {
      return name.toLowerCase()
        .replace(/[’'"]/g, '')
        .replace(/\s+/g, '_')
        .replace(/[^a-z0-9_-]/g, '');
    }

    function getWord(num, wordList) {
      return wordList[num - 1] || num;
    }

    function generate() {
      const numPlayers = parseInt(document.getElementById("numPlayers").value);
      if (isNaN(numPlayers) || numPlayers < 1 || numPlayers > 5) {
        alert("Please enter a number between 1 and 5.");
        return;
      }

      const playerResults = document.getElementById("playerResults");
      const bossSection = document.getElementById("bossSection");
      const episodeSection = document.getElementById("episodeSection");

      playerResults.innerHTML = "";
      bossSection.innerHTML = "";
      episodeSection.innerHTML = "";

      const used = [];
      const usedRelics = [];
      const usedPathologies = [];

      for (let i = 0; i < numPlayers; i++) {
        const box = document.createElement("div");
        box.className = "player-box";

        // Investigator
        const remaining = Array.from({ length: 20 }, (_, j) => j + 1).filter(n => !used.includes(n));
        const selected = remaining[Math.floor(Math.random() * remaining.length)];
        used.push(selected);
        const name = getWord(selected, words1to20);
        const fileName = sanitizeFileName(name) + ".png";

        const playerDiv = document.createElement("div");
        playerDiv.className = "player-output";
        const img = document.createElement("img");
        img.src = "assets/" + fileName;
        img.alt = name;
        img.onerror = () => { img.style.display = "none"; };
        const textSpan = document.createElement("span");
        textSpan.innerHTML = `Investigator: <em class="bold-italic">${name}</em>`;
        playerDiv.appendChild(img);
        playerDiv.appendChild(textSpan);
        box.appendChild(playerDiv);

        // Relic
        const relicRemaining = Array.from({ length: 22 }, (_, j) => j + 1).filter(n => !usedRelics.includes(n));
        const relicNum = relicRemaining[Math.floor(Math.random() * relicRemaining.length)];
        usedRelics.push(relicNum);
        const relicName = getWord(relicNum, relics1to22);
        const relicFile = sanitizeFileName(relicName) + ".png";
        const relicDiv = document.createElement("div");
        relicDiv.className = "relic-output";
        const relicImg = document.createElement("img");
        relicImg.src = "assets/" + relicFile;
        relicImg.alt = relicName;
        relicImg.onerror = () => { relicImg.style.display = "none"; };
        const relicLabel = document.createElement("span");
        relicLabel.innerHTML = `Relic: <em class="bold-italic">${relicName}</em>`;
        relicDiv.appendChild(relicImg);
        relicDiv.appendChild(relicLabel);
        box.appendChild(relicDiv);

        // Pathology
        const pathologyRemaining = Array.from({ length: 12 }, (_, j) => j + 1).filter(n => !usedPathologies.includes(n));
        const pathologyNum = pathologyRemaining[Math.floor(Math.random() * pathologyRemaining.length)];
        usedPathologies.push(pathologyNum);
        const pathologyName = getWord(pathologyNum, pathologies1to12);
        const pathologyFile = sanitizeFileName(pathologyName) + ".png";
        const pathologyDiv = document.createElement("div");
        pathologyDiv.className = "disorder-output";
        const pathologyImg = document.createElement("img");
        pathologyImg.src = "assets/" + pathologyFile;
        pathologyImg.alt = pathologyName;
        pathologyImg.onerror = () => { pathologyImg.style.display = "none"; };
        const pathologyLabel = document.createElement("span");
        pathologyLabel.innerHTML = `Pathology: <em class="bold-italic">${pathologyName}</em>`;
        pathologyDiv.appendChild(pathologyImg);
        pathologyDiv.appendChild(pathologyLabel);
        box.appendChild(pathologyDiv);

        playerResults.appendChild(box);
      }

      // Boss
      const bossNum = Math.floor(Math.random() * 4) + 1;
      const bossName = getWord(bossNum, words1to4);
      const bossFile = sanitizeFileName(bossName) + ".png";

      const bossDiv = document.createElement("div");
      bossDiv.className = "player-output";
      const bossImg = document.createElement("img");
      bossImg.src = "assets/" + bossFile;
      bossImg.alt = bossName;
      bossImg.onerror = () => { bossImg.style.display = "none"; };
      const bossSpan = document.createElement("span");
      bossSpan.innerHTML = `Boss: <em class="bold-italic">${bossName}</em>`;
      bossDiv.appendChild(bossImg);
      bossDiv.appendChild(bossSpan);
      bossSection.appendChild(bossDiv);

      // Episode
      const epNum = Math.floor(Math.random() * 12) + 1;
      const epFull = getWord(epNum, episodes1to12);
      const epCode = epFull.split(" ")[0];
      const epFile = epCode.toLowerCase() + ".png";

      const epDiv = document.createElement("div");
      epDiv.className = "player-output";
      const epImg = document.createElement("img");
      epImg.src = "assets/" + epFile;
      epImg.alt = epCode;
      epImg.onerror = () => { epImg.style.display = "none"; };
      const epSpan = document.createElement("span");
      epSpan.innerHTML = `Episode: <em class="bold-italic">${epFull}</em>`;
      epDiv.appendChild(epImg);
      epDiv.appendChild(epSpan);
      episodeSection.appendChild(epDiv);
    }
  </script>
</body>
</html>
